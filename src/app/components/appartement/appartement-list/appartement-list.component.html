<section class="appartement-list">
  <div class="container">
    <div class="appartement-list-container content-container">
      <div class="appartement-list-header content-header">
        <h2>Liste des biens</h2>
        <button
          class="{{filtresIsVisibles ? 'selected' : ''}}"
          (click)="toggleFiltres()">
          <span>{{filtresIsVisibles ? 'Fermer' : 'Statistiques'}} </span>
          <img src="assets/img/{{filtresIsVisibles ? 'close' : 'filtre'}}-icon.svg" alt="statistique icon">
        </button>
      </div>
      <ul class="appartement-list-filtres-list"
      *ngIf="filtresIsVisibles">
        <li class="appartement-list-filtres-item" *ngFor="let filtre of filtresList">
          <label>
            <input type="checkbox" [(ngModel)]="filtreActif[filtre.id]" (change)="toggleFiltre(filtre.id)" />
            {{ filtre.nom }}
          </label>
        </li>
      </ul>
      <ul class="appartement-list-list">
        <li
          class="appartement-list-item"
          *ngFor="let adresseAppartement of adressesAppartement"
          [ngClass]="{'selected': adresseAppartement.selected, 'selection-active': selectionMode}">
          <div
            class="appartement-list-item-container"
            *ngIf="adresseAppartement.id !== undefined"
            (click)="selectionMode ? toggleSelection(adresseAppartement) : viewAppartement(adresseAppartement.id)">
            <div class="appartement-list-item-contenu">
              <div>
                <h3>{{ adresseAppartement.numero }} {{ adresseAppartement.adresse }}</h3>
                <p>{{ adresseAppartement.codePostal }} {{ adresseAppartement.ville }}, {{adresseAppartement.pays.name}}</p>
              </div>
              <img src="./assets/img/view-more-icon.svg" alt="">
            </div>
            <ul class="appartement-list-filtres-selected-list">
              <li class="appartement-list-filtres-selected-item" [ngClass]="{'selected': adresseAppartement.selected}" *ngFor="let filtre of filtresList">
                <div *ngIf="filtreActif.includes(filtre.id) && filtre.id !== 'taux_occupation'">
                  <p><strong>{{ filtre.nom }}:</strong>
                    {{ getAppartementProperty(adresseAppartement.id, filtre.prop) | number:'1.2-2':'fr-FR' }} €
                  </p>
                </div>
                <div *ngIf="filtreActif.includes(filtre.id) && filtre.id === 'taux_occupation'">
                  <p><strong>{{ filtre.nom }}:</strong>
                    {{ (100 - getAppartementProperty(adresseAppartement.id, filtre.prop)) | number:'1.2-2':'fr-FR' }} %
                  </p>
                </div>
              </li>
            </ul>
          </div>
        </li>
      </ul>
    </div>
    <div class="appartement-metriques-container content-container" *ngIf="isProprietaire()">
      <div class="appartement-metriques-header content-header">
        <h2>Chiffres clés</h2>
        <button
          class="cc-btn {{selectionMode ? 'selected' : ''}}"
          (click)="toggleSelectionMode()">
          <span>{{selectionMode ? 'Annuler' : 'Sélectionner'}} </span>
          <img src="assets/img/{{selectionMode ? 'close' : 'filtre'}}-icon.svg" alt="statistique icon">
        </button>
      </div>
      <ul class="appartement-metriques-list">
        <li>
          <span>Valeur totale</span>
          <span class="chiffre">{{ totalCC.prixAchat | number:'1.2-2' }} €</span>
        </li>
        <li>
          <span>Estimation totale</span>
          <span class="chiffre">{{ totalCC.estimation | number:'1.2-2' }} €</span>
        </li>
        <li>
          <span>Revenus totaux</span>
          <span class="chiffre">{{ totalCC.revenusNets | number:'1.2-2' }} €</span>
        </li>
        <li>
          <span>Dépenses totales</span>
          <span class="chiffre">{{ totalCC.depensesNettes | number:'1.2-2' }} €</span>
        </li>
        <li>
          <span>Bénéfice net</span>
          <span class="chiffre">{{ totalCC.revenusNets - totalCC.depensesNettes | number:'1.2-2' }} €</span>
        </li>
        <li>
          <span>Taux de provision</span>
          <span class="chiffre">{{ totalCC.depensesNettes / totalCC.revenusNets * 100 | number:'1.2-2' }} %</span>
        </li>
      </ul>
    </div>
  </div>
</section>
