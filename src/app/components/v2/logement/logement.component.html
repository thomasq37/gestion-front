<section class="logement">
  <app-header [h1]="'Synthèse logement'"></app-header>
  <div class="contenu-logement {{loading ? 'on-load' : ''}}">
    <app-loader *ngIf="loading"></app-loader>
    <div class="container-fil-ariane">
      <app-fil-ariane
        *ngIf="logement"
        [ongletRetour]="{url: '/logements', label:'Vue d\'ensemble'}"
        [ongletActuel]="'Synthèse logement'"></app-fil-ariane>
    </div>
    <app-photo-caroussel
      *ngIf="logement"
      [onItem]="true"
      [photos]="logement.photos"
      [logementId]="logement.masqueId"></app-photo-caroussel>
    <div class="container" *ngIf="logement">
      <div class="logement-infos" *ngIf="logement.adresse && logement.caracteristiques">
        <h2>{{logement.caracteristiques.typeDeLogement | titlecase}} {{logement.adresse.numero}} {{logement.adresse.voie}}</h2>
        <p class="prix-loyer-actuelle">{{getTarifActuel(logement.periodesDeLocation)}}</p>
        <div class="details-logement">
          <div>{{logement.caracteristiques.nombreDePieces}} pièces</div>
          <div>{{logement.caracteristiques.surfaceLogement }} m²</div>
          <div>{{logement.caracteristiques.meubleeOuNon ? 'Meublé' : 'Non meublé'}}</div>
          <div *ngIf="logement.caracteristiques.parkingOuNon">Parking</div>
          <div *ngIf="logement.caracteristiques.balconOuTerrasse">{{getBalconOuTerrasse(logement.caracteristiques)}}</div>
        </div>
        <img class="dpe-logement" *ngIf="logement.caracteristiques.dpeLettre !== null" src="./assets/img/v2/energie-{{logement.caracteristiques.dpeLettre.toLowerCase()}}-icon.png" alt="Icône de la classe énergie">

      </div>
      <nav class="nav-logement">
        <ul>
          <li
            *ngFor="let item of menuItems; let i = index"
            (click)="setActive(i)"
            [ngClass]="{'active': activeIndex === i}"
          >
            {{ item }}
          </li>
        </ul>
      </nav>
      <app-adresse-element
        *ngIf="activeIndex === 0"
        [logementMasqueId]="logement.masqueId"
        [adresse]="logement.adresse">
      </app-adresse-element>
      <app-caracteristiques-element
        *ngIf="activeIndex === 1"
        [logementMasqueId]="logement.masqueId"
        [caracteristiques]="logement.caracteristiques">
      </app-caracteristiques-element>
      <app-frais-table
        *ngIf="activeIndex === 2"
        [logementMasqueId]="logement.masqueId"
        [frais]="logement.frais">
      </app-frais-table>
      <app-periode-location-table
        *ngIf="activeIndex === 3"
        [logementMasqueId]="logement.masqueId"
        [periodesDeLocation]="logement.periodesDeLocation"
        (periodeSelectionnee)="onPeriodeSelectionnee($event)">
      </app-periode-location-table>
      <app-locataire-table
        *ngIf="activeIndex === 4"
        [logementMasqueId]="logement.masqueId"
        [locataires]="getLocataires()">
      </app-locataire-table>
      <app-contact-table
        *ngIf="activeIndex === 5"
        [logementMasqueId]="logement.masqueId"
        [contacts]="logement.contacts">
      </app-contact-table>
      <app-alerte-table
        *ngIf="activeIndex === 6"
        [logementMasqueId]="logement.masqueId"
        [alertes]="logement.alertes">
      </app-alerte-table>
      <button *ngIf="activeIndex === 7" class="btn-supprimer-logement" (click)="supprimerLogement(logement.masqueId)">Supprimer le logement</button>
      <nav class="nav-logement periode-de-location" *ngIf="activeIndex === 3">
        <ul>
          <li
            *ngFor="let item of menuPeriodesDeLocation"
            [ngClass]="{'active': activeIndexPeriodeDeLocation === 0}"
          >
            {{ item }}
          </li>
        </ul>
      </nav>
      <app-frais-table
        *ngIf="activeIndex === 3 && periodeActuelle !== null"
        [logementMasqueId]="logement.masqueId"
        [periodeMasqueId]="periodeActuelle.masqueId"
        [frais]="periodeActuelle.frais">
      </app-frais-table>
    </div>
  </div>
</section>
